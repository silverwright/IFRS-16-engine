import XLSX from 'xlsx';
import path from 'path';
import { fileURLToPath } from 'url';

const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);

// Define all contract headers based on LeaseData interface
const headers = [
  // Basic identifiers
  'ContractID',
  'LesseeEntity',
  'LessorName',
  'AssetDescription',
  'AssetClass',

  // Dates
  'ContractDate',
  'CommencementDate',
  'EndDateOriginal',

  // Term & Options
  'NonCancellableYears',
  'RenewalOptionYears',
  'RenewalOptionLikelihood',
  'TerminationOptionPoint',
  'TerminationOptionLikelihood',
  'TerminationPenaltyExpected',
  'TerminationReasonablyCertain',

  // Payments
  'FixedPaymentPerPeriod',
  'PaymentFrequency',
  'PaymentTiming',

  // Escalation
  'EscalationType',
  'BaseCPI',
  'CPIResetMonth',
  'FirstResetYearOffset',
  'FixedEscalationPct',

  // Variable & Other
  'VariablePaymentsInSubstanceFixed',
  'VariablePaymentsUsageExpected',
  'RVGExpected',
  'RVGReasonablyCertain',
  'PurchaseOptionPrice',
  'PurchaseOptionReasonablyCertain',

  // Asset Valuation
  'CarryingAmount',
  'FairValue',
  'SalesProceeds',

  // ROU Adjustments
  'InitialDirectCosts',
  'PrepaymentsBeforeCommencement',
  'LeaseIncentives',
  'PrepaidFirstPayment',

  // Currency & Rates
  'Currency',
  'IBR_Annual',
  'FXPolicy',

  // Asset Life
  'UsefulLifeYears',

  // Policy Flags
  'LowValueExemption',
  'ShortTermExemption',
  'SeparateNonLeaseComponents',
  'AllocationBasis',

  // Governance
  'JudgementNotes',
  'ApprovalSignoff',

  // Full mode extensions (optional)
  'LessorJurisdiction',
  'LesseeJurisdiction',
  'LessorAddress',
  'LesseeAddress',
  'LessorRCNumber',
  'LesseeRCNumber',
  'AssetLocation',
  'DeliveryDateLatest',
  'RiskTransferEvent',
  'InsuranceSumInsured',
  'InsuranceTPLimit',
  'InsurerRatingMin',
  'PermittedUse',
  'MoveRestriction',
  'SoftwareLicense',
  'BankName',
  'BankAccountName',
  'BankAccountNo',
  'ArbitrationRules',
  'SeatOfArbitration',
  'Language',
  'GoverningLaw',
  'LessorSignatoryTitle',
  'LesseeSignatoryTitle'
];

// Generate demo data (10 rows)
const demoData = [
  {
    ContractID: 'LC-2024-001',
    LesseeEntity: 'TechCorp Nigeria Ltd',
    LessorName: 'Prime Properties Ltd',
    AssetDescription: 'Office Building - Victoria Island',
    AssetClass: 'Real Estate',
    ContractDate: '2024-01-15',
    CommencementDate: '2024-02-01',
    EndDateOriginal: '2029-01-31',
    NonCancellableYears: 5,
    RenewalOptionYears: 3,
    RenewalOptionLikelihood: 0.7,
    TerminationOptionPoint: '',
    TerminationOptionLikelihood: 0,
    TerminationPenaltyExpected: 0,
    TerminationReasonablyCertain: false,
    FixedPaymentPerPeriod: 2500000,
    PaymentFrequency: 'Monthly',
    PaymentTiming: 'In Advance',
    EscalationType: 'Fixed %',
    BaseCPI: 0,
    CPIResetMonth: 0,
    FirstResetYearOffset: 0,
    FixedEscalationPct: 0.05,
    VariablePaymentsInSubstanceFixed: 0,
    VariablePaymentsUsageExpected: 0,
    RVGExpected: 0,
    RVGReasonablyCertain: false,
    PurchaseOptionPrice: 0,
    PurchaseOptionReasonablyCertain: false,
    CarryingAmount: 0,
    FairValue: 0,
    SalesProceeds: 0,
    InitialDirectCosts: 500000,
    PrepaymentsBeforeCommencement: 0,
    LeaseIncentives: 0,
    PrepaidFirstPayment: true,
    Currency: 'NGN',
    IBR_Annual: 0.15,
    FXPolicy: 'Spot Rate',
    UsefulLifeYears: 25,
    LowValueExemption: false,
    ShortTermExemption: false,
    SeparateNonLeaseComponents: true,
    AllocationBasis: 'Standalone Price',
    JudgementNotes: 'Renewal option highly probable based on business expansion plans',
    ApprovalSignoff: 'CFO - John Doe',
    LessorJurisdiction: 'Nigeria',
    LesseeJurisdiction: 'Nigeria',
    LessorAddress: '15 Adeola Odeku Street, Victoria Island, Lagos',
    LesseeAddress: '23 Admiralty Way, Lekki Phase 1, Lagos',
    LessorRCNumber: 'RC123456',
    LesseeRCNumber: 'RC789012',
    AssetLocation: 'Plot 45, Victoria Island, Lagos',
    DeliveryDateLatest: '2024-02-01',
    RiskTransferEvent: 'Upon delivery',
    InsuranceSumInsured: 500000000,
    InsuranceTPLimit: 100000000,
    InsurerRatingMin: 'A',
    PermittedUse: 'Office operations only',
    MoveRestriction: 'Fixed location',
    SoftwareLicense: '',
    BankName: 'Access Bank Plc',
    BankAccountName: 'Prime Properties Ltd',
    BankAccountNo: '0123456789',
    ArbitrationRules: 'LCIA Rules',
    SeatOfArbitration: 'Lagos, Nigeria',
    Language: 'English',
    GoverningLaw: 'Laws of Nigeria',
    LessorSignatoryTitle: 'Managing Director',
    LesseeSignatoryTitle: 'Chief Financial Officer'
  },
  {
    ContractID: 'LC-2024-002',
    LesseeEntity: 'TechCorp Nigeria Ltd',
    LessorName: 'AutoFleet Services Ltd',
    AssetDescription: 'Toyota Hilux 2024 Model',
    AssetClass: 'Vehicles',
    ContractDate: '2024-03-10',
    CommencementDate: '2024-03-15',
    EndDateOriginal: '2028-03-14',
    NonCancellableYears: 4,
    RenewalOptionYears: 2,
    RenewalOptionLikelihood: 0.5,
    TerminationOptionPoint: '2026-03-14',
    TerminationOptionLikelihood: 0.3,
    TerminationPenaltyExpected: 1500000,
    TerminationReasonablyCertain: false,
    FixedPaymentPerPeriod: 350000,
    PaymentFrequency: 'Monthly',
    PaymentTiming: 'In Advance',
    EscalationType: 'None',
    BaseCPI: 0,
    CPIResetMonth: 0,
    FirstResetYearOffset: 0,
    FixedEscalationPct: 0,
    VariablePaymentsInSubstanceFixed: 0,
    VariablePaymentsUsageExpected: 50000,
    RVGExpected: 0,
    RVGReasonablyCertain: false,
    PurchaseOptionPrice: 8000000,
    PurchaseOptionReasonablyCertain: false,
    CarryingAmount: 0,
    FairValue: 15000000,
    SalesProceeds: 0,
    InitialDirectCosts: 100000,
    PrepaymentsBeforeCommencement: 0,
    LeaseIncentives: 200000,
    PrepaidFirstPayment: true,
    Currency: 'NGN',
    IBR_Annual: 0.18,
    FXPolicy: 'Spot Rate',
    UsefulLifeYears: 8,
    LowValueExemption: false,
    ShortTermExemption: false,
    SeparateNonLeaseComponents: true,
    AllocationBasis: 'Standalone Price',
    JudgementNotes: 'Variable payments for excess mileage excluded from liability measurement',
    ApprovalSignoff: 'CFO - John Doe',
    LessorJurisdiction: 'Nigeria',
    LesseeJurisdiction: 'Nigeria',
    LessorAddress: '89 Opebi Road, Ikeja, Lagos',
    LesseeAddress: '23 Admiralty Way, Lekki Phase 1, Lagos',
    LessorRCNumber: 'RC345678',
    LesseeRCNumber: 'RC789012',
    AssetLocation: 'TechCorp Premises, Lekki',
    DeliveryDateLatest: '2024-03-15',
    RiskTransferEvent: 'Upon delivery',
    InsuranceSumInsured: 15000000,
    InsuranceTPLimit: 5000000,
    InsurerRatingMin: 'B+',
    PermittedUse: 'Business use within Nigeria',
    MoveRestriction: 'No international travel',
    SoftwareLicense: '',
    BankName: 'GTBank Plc',
    BankAccountName: 'AutoFleet Services Ltd',
    BankAccountNo: '0987654321',
    ArbitrationRules: 'LCIA Rules',
    SeatOfArbitration: 'Lagos, Nigeria',
    Language: 'English',
    GoverningLaw: 'Laws of Nigeria',
    LessorSignatoryTitle: 'Chief Executive Officer',
    LesseeSignatoryTitle: 'Procurement Manager'
  },
  {
    ContractID: 'LC-2024-003',
    LesseeEntity: 'Manufacturing Solutions Ltd',
    LessorName: 'Industrial Equipment Leasing',
    AssetDescription: 'CNC Machine Model XYZ-5000',
    AssetClass: 'Equipment',
    ContractDate: '2024-02-20',
    CommencementDate: '2024-03-01',
    EndDateOriginal: '2031-02-28',
    NonCancellableYears: 7,
    RenewalOptionYears: 0,
    RenewalOptionLikelihood: 0,
    TerminationOptionPoint: '',
    TerminationOptionLikelihood: 0,
    TerminationPenaltyExpected: 0,
    TerminationReasonablyCertain: false,
    FixedPaymentPerPeriod: 1200000,
    PaymentFrequency: 'Monthly',
    PaymentTiming: 'In Arrears',
    EscalationType: 'CPI-Based',
    BaseCPI: 100,
    CPIResetMonth: 3,
    FirstResetYearOffset: 1,
    FixedEscalationPct: 0,
    VariablePaymentsInSubstanceFixed: 0,
    VariablePaymentsUsageExpected: 0,
    RVGExpected: 0,
    RVGReasonablyCertain: false,
    PurchaseOptionPrice: 25000000,
    PurchaseOptionReasonablyCertain: true,
    CarryingAmount: 0,
    FairValue: 95000000,
    SalesProceeds: 0,
    InitialDirectCosts: 2500000,
    PrepaymentsBeforeCommencement: 1200000,
    LeaseIncentives: 0,
    PrepaidFirstPayment: false,
    Currency: 'NGN',
    IBR_Annual: 0.14,
    FXPolicy: 'Spot Rate',
    UsefulLifeYears: 15,
    LowValueExemption: false,
    ShortTermExemption: false,
    SeparateNonLeaseComponents: true,
    AllocationBasis: 'Standalone Price',
    JudgementNotes: 'Purchase option at below market price indicates reasonably certain exercise',
    ApprovalSignoff: 'CFO - Jane Smith',
    LessorJurisdiction: 'Nigeria',
    LesseeJurisdiction: 'Nigeria',
    LessorAddress: '56 Trans Amadi Industrial Layout, Port Harcourt',
    LesseeAddress: '12 Factory Road, Industrial Estate, Aba',
    LessorRCNumber: 'RC567890',
    LesseeRCNumber: 'RC234567',
    AssetLocation: 'Manufacturing Plant, Aba',
    DeliveryDateLatest: '2024-03-01',
    RiskTransferEvent: 'Upon installation',
    InsuranceSumInsured: 95000000,
    InsuranceTPLimit: 20000000,
    InsurerRatingMin: 'A-',
    PermittedUse: 'Manufacturing operations',
    MoveRestriction: 'Fixed installation',
    SoftwareLicense: '',
    BankName: 'First Bank of Nigeria',
    BankAccountName: 'Industrial Equipment Leasing',
    BankAccountNo: '1122334455',
    ArbitrationRules: 'ICC Rules',
    SeatOfArbitration: 'Lagos, Nigeria',
    Language: 'English',
    GoverningLaw: 'Laws of Nigeria',
    LessorSignatoryTitle: 'Director of Operations',
    LesseeSignatoryTitle: 'Chief Operations Officer'
  },
  {
    ContractID: 'LC-2024-004',
    LesseeEntity: 'RetailChain Nigeria Ltd',
    LessorName: 'Commercial Properties Co',
    AssetDescription: 'Retail Store - Ikeja City Mall',
    AssetClass: 'Real Estate',
    ContractDate: '2024-01-05',
    CommencementDate: '2024-02-01',
    EndDateOriginal: '2034-01-31',
    NonCancellableYears: 10,
    RenewalOptionYears: 5,
    RenewalOptionLikelihood: 0.8,
    TerminationOptionPoint: '',
    TerminationOptionLikelihood: 0,
    TerminationPenaltyExpected: 0,
    TerminationReasonablyCertain: false,
    FixedPaymentPerPeriod: 3500000,
    PaymentFrequency: 'Monthly',
    PaymentTiming: 'In Advance',
    EscalationType: 'Fixed %',
    BaseCPI: 0,
    CPIResetMonth: 0,
    FirstResetYearOffset: 0,
    FixedEscalationPct: 0.03,
    VariablePaymentsInSubstanceFixed: 0,
    VariablePaymentsUsageExpected: 500000,
    RVGExpected: 0,
    RVGReasonablyCertain: false,
    PurchaseOptionPrice: 0,
    PurchaseOptionReasonablyCertain: false,
    CarryingAmount: 0,
    FairValue: 0,
    SalesProceeds: 0,
    InitialDirectCosts: 1500000,
    PrepaymentsBeforeCommencement: 3500000,
    LeaseIncentives: 5000000,
    PrepaidFirstPayment: true,
    Currency: 'NGN',
    IBR_Annual: 0.16,
    FXPolicy: 'Spot Rate',
    UsefulLifeYears: 30,
    LowValueExemption: false,
    ShortTermExemption: false,
    SeparateNonLeaseComponents: true,
    AllocationBasis: 'Standalone Price',
    JudgementNotes: 'Variable payments based on sales turnover excluded from initial measurement',
    ApprovalSignoff: 'CEO - Michael Brown',
    LessorJurisdiction: 'Nigeria',
    LesseeJurisdiction: 'Nigeria',
    LessorAddress: '100 Obafemi Awolowo Way, Ikeja, Lagos',
    LesseeAddress: '45 Allen Avenue, Ikeja, Lagos',
    LessorRCNumber: 'RC678901',
    LesseeRCNumber: 'RC890123',
    AssetLocation: 'Shop 23, Ikeja City Mall, Lagos',
    DeliveryDateLatest: '2024-02-01',
    RiskTransferEvent: 'Upon handover',
    InsuranceSumInsured: 200000000,
    InsuranceTPLimit: 50000000,
    InsurerRatingMin: 'A+',
    PermittedUse: 'Retail operations',
    MoveRestriction: 'Fixed location',
    SoftwareLicense: '',
    BankName: 'Zenith Bank Plc',
    BankAccountName: 'Commercial Properties Co',
    BankAccountNo: '2233445566',
    ArbitrationRules: 'LCIA Rules',
    SeatOfArbitration: 'Lagos, Nigeria',
    Language: 'English',
    GoverningLaw: 'Laws of Nigeria',
    LessorSignatoryTitle: 'Managing Director',
    LesseeSignatoryTitle: 'Chief Executive Officer'
  },
  {
    ContractID: 'LC-2024-005',
    LesseeEntity: 'Logistics Express Ltd',
    LessorName: 'Warehouse Solutions Ltd',
    AssetDescription: 'Distribution Center - Apapa',
    AssetClass: 'Real Estate',
    ContractDate: '2024-03-01',
    CommencementDate: '2024-04-01',
    EndDateOriginal: '2032-03-31',
    NonCancellableYears: 8,
    RenewalOptionYears: 4,
    RenewalOptionLikelihood: 0.6,
    TerminationOptionPoint: '2028-03-31',
    TerminationOptionLikelihood: 0.2,
    TerminationPenaltyExpected: 10000000,
    TerminationReasonablyCertain: false,
    FixedPaymentPerPeriod: 4500000,
    PaymentFrequency: 'Monthly',
    PaymentTiming: 'In Advance',
    EscalationType: 'CPI-Based',
    BaseCPI: 100,
    CPIResetMonth: 4,
    FirstResetYearOffset: 1,
    FixedEscalationPct: 0,
    VariablePaymentsInSubstanceFixed: 0,
    VariablePaymentsUsageExpected: 0,
    RVGExpected: 0,
    RVGReasonablyCertain: false,
    PurchaseOptionPrice: 0,
    PurchaseOptionReasonablyCertain: false,
    CarryingAmount: 0,
    FairValue: 0,
    SalesProceeds: 0,
    InitialDirectCosts: 3000000,
    PrepaymentsBeforeCommencement: 0,
    LeaseIncentives: 0,
    PrepaidFirstPayment: true,
    Currency: 'NGN',
    IBR_Annual: 0.17,
    FXPolicy: 'Spot Rate',
    UsefulLifeYears: 35,
    LowValueExemption: false,
    ShortTermExemption: false,
    SeparateNonLeaseComponents: true,
    AllocationBasis: 'Standalone Price',
    JudgementNotes: 'Termination option not reasonably certain due to high penalty',
    ApprovalSignoff: 'CFO - Sarah Williams',
    LessorJurisdiction: 'Nigeria',
    LesseeJurisdiction: 'Nigeria',
    LessorAddress: '78 Warehouse Road, Apapa, Lagos',
    LesseeAddress: '34 Marine Road, Apapa, Lagos',
    LessorRCNumber: 'RC901234',
    LesseeRCNumber: 'RC012345',
    AssetLocation: 'Block C, Warehouse Complex, Apapa',
    DeliveryDateLatest: '2024-04-01',
    RiskTransferEvent: 'Upon handover',
    InsuranceSumInsured: 800000000,
    InsuranceTPLimit: 150000000,
    InsurerRatingMin: 'A',
    PermittedUse: 'Warehousing and distribution',
    MoveRestriction: 'Fixed location',
    SoftwareLicense: '',
    BankName: 'UBA Plc',
    BankAccountName: 'Warehouse Solutions Ltd',
    BankAccountNo: '3344556677',
    ArbitrationRules: 'ICC Rules',
    SeatOfArbitration: 'Lagos, Nigeria',
    Language: 'English',
    GoverningLaw: 'Laws of Nigeria',
    LessorSignatoryTitle: 'Executive Director',
    LesseeSignatoryTitle: 'Chief Financial Officer'
  },
  {
    ContractID: 'LC-2024-006',
    LesseeEntity: 'Tech Innovators Ltd',
    LessorName: 'Office Space Rentals',
    AssetDescription: 'Co-working Space - Yaba Tech Hub',
    AssetClass: 'Real Estate',
    ContractDate: '2024-02-15',
    CommencementDate: '2024-03-01',
    EndDateOriginal: '2027-02-28',
    NonCancellableYears: 3,
    RenewalOptionYears: 2,
    RenewalOptionLikelihood: 0.5,
    TerminationOptionPoint: '',
    TerminationOptionLikelihood: 0,
    TerminationPenaltyExpected: 0,
    TerminationReasonablyCertain: false,
    FixedPaymentPerPeriod: 800000,
    PaymentFrequency: 'Monthly',
    PaymentTiming: 'In Advance',
    EscalationType: 'Fixed %',
    BaseCPI: 0,
    CPIResetMonth: 0,
    FirstResetYearOffset: 0,
    FixedEscalationPct: 0.04,
    VariablePaymentsInSubstanceFixed: 0,
    VariablePaymentsUsageExpected: 0,
    RVGExpected: 0,
    RVGReasonablyCertain: false,
    PurchaseOptionPrice: 0,
    PurchaseOptionReasonablyCertain: false,
    CarryingAmount: 0,
    FairValue: 0,
    SalesProceeds: 0,
    InitialDirectCosts: 150000,
    PrepaymentsBeforeCommencement: 0,
    LeaseIncentives: 1000000,
    PrepaidFirstPayment: true,
    Currency: 'NGN',
    IBR_Annual: 0.19,
    FXPolicy: 'Spot Rate',
    UsefulLifeYears: 20,
    LowValueExemption: false,
    ShortTermExemption: false,
    SeparateNonLeaseComponents: true,
    AllocationBasis: 'Standalone Price',
    JudgementNotes: 'Short-term lease with moderate renewal probability',
    ApprovalSignoff: 'CEO - David Chen',
    LessorJurisdiction: 'Nigeria',
    LesseeJurisdiction: 'Nigeria',
    LessorAddress: '12 Herbert Macaulay Way, Yaba, Lagos',
    LesseeAddress: '25 Sabo Road, Yaba, Lagos',
    LessorRCNumber: 'RC123987',
    LesseeRCNumber: 'RC456321',
    AssetLocation: 'Floor 3, Innovation Center, Yaba',
    DeliveryDateLatest: '2024-03-01',
    RiskTransferEvent: 'Upon access',
    InsuranceSumInsured: 50000000,
    InsuranceTPLimit: 10000000,
    InsurerRatingMin: 'B+',
    PermittedUse: 'Office and tech development',
    MoveRestriction: 'Fixed location',
    SoftwareLicense: '',
    BankName: 'Stanbic IBTC Bank',
    BankAccountName: 'Office Space Rentals',
    BankAccountNo: '4455667788',
    ArbitrationRules: 'LCIA Rules',
    SeatOfArbitration: 'Lagos, Nigeria',
    Language: 'English',
    GoverningLaw: 'Laws of Nigeria',
    LessorSignatoryTitle: 'General Manager',
    LesseeSignatoryTitle: 'Chief Executive Officer'
  },
  {
    ContractID: 'LC-2024-007',
    LesseeEntity: 'Medical Services Ltd',
    LessorName: 'Healthcare Equipment Ltd',
    AssetDescription: 'MRI Scanner Model Pro-3000',
    AssetClass: 'Equipment',
    ContractDate: '2024-01-20',
    CommencementDate: '2024-02-15',
    EndDateOriginal: '2032-02-14',
    NonCancellableYears: 8,
    RenewalOptionYears: 0,
    RenewalOptionLikelihood: 0,
    TerminationOptionPoint: '',
    TerminationOptionLikelihood: 0,
    TerminationPenaltyExpected: 0,
    TerminationReasonablyCertain: false,
    FixedPaymentPerPeriod: 5500000,
    PaymentFrequency: 'Monthly',
    PaymentTiming: 'In Advance',
    EscalationType: 'Fixed %',
    BaseCPI: 0,
    CPIResetMonth: 0,
    FirstResetYearOffset: 0,
    FixedEscalationPct: 0.02,
    VariablePaymentsInSubstanceFixed: 0,
    VariablePaymentsUsageExpected: 200000,
    RVGExpected: 0,
    RVGReasonablyCertain: false,
    PurchaseOptionPrice: 150000000,
    PurchaseOptionReasonablyCertain: false,
    CarryingAmount: 0,
    FairValue: 450000000,
    SalesProceeds: 0,
    InitialDirectCosts: 15000000,
    PrepaymentsBeforeCommencement: 5500000,
    LeaseIncentives: 0,
    PrepaidFirstPayment: true,
    Currency: 'NGN',
    IBR_Annual: 0.13,
    FXPolicy: 'Spot Rate',
    UsefulLifeYears: 12,
    LowValueExemption: false,
    ShortTermExemption: false,
    SeparateNonLeaseComponents: true,
    AllocationBasis: 'Standalone Price',
    JudgementNotes: 'Variable payments for excess usage excluded from measurement',
    ApprovalSignoff: 'MD - Dr. Amina Bello',
    LessorJurisdiction: 'Nigeria',
    LesseeJurisdiction: 'Nigeria',
    LessorAddress: '67 Medical Equipment Drive, Abuja',
    LesseeAddress: '89 Hospital Road, Victoria Island, Lagos',
    LessorRCNumber: 'RC789654',
    LesseeRCNumber: 'RC321456',
    AssetLocation: 'Radiology Department, Medical Center',
    DeliveryDateLatest: '2024-02-15',
    RiskTransferEvent: 'Upon installation and testing',
    InsuranceSumInsured: 450000000,
    InsuranceTPLimit: 100000000,
    InsurerRatingMin: 'A+',
    PermittedUse: 'Medical diagnostics',
    MoveRestriction: 'Fixed installation',
    SoftwareLicense: 'Included in lease',
    BankName: 'Ecobank Nigeria',
    BankAccountName: 'Healthcare Equipment Ltd',
    BankAccountNo: '5566778899',
    ArbitrationRules: 'ICC Rules',
    SeatOfArbitration: 'Abuja, Nigeria',
    Language: 'English',
    GoverningLaw: 'Laws of Nigeria',
    LessorSignatoryTitle: 'Chief Executive Officer',
    LesseeSignatoryTitle: 'Medical Director'
  },
  {
    ContractID: 'LC-2024-008',
    LesseeEntity: 'Transport Solutions Ltd',
    LessorName: 'Fleet Management Co',
    AssetDescription: 'Mercedes Sprinter Van 2024',
    AssetClass: 'Vehicles',
    ContractDate: '2024-02-10',
    CommencementDate: '2024-02-20',
    EndDateOriginal: '2029-02-19',
    NonCancellableYears: 5,
    RenewalOptionYears: 0,
    RenewalOptionLikelihood: 0,
    TerminationOptionPoint: '2027-02-19',
    TerminationOptionLikelihood: 0.4,
    TerminationPenaltyExpected: 2000000,
    TerminationReasonablyCertain: false,
    FixedPaymentPerPeriod: 550000,
    PaymentFrequency: 'Monthly',
    PaymentTiming: 'In Advance',
    EscalationType: 'None',
    BaseCPI: 0,
    CPIResetMonth: 0,
    FirstResetYearOffset: 0,
    FixedEscalationPct: 0,
    VariablePaymentsInSubstanceFixed: 0,
    VariablePaymentsUsageExpected: 100000,
    RVGExpected: 5000000,
    RVGReasonablyCertain: true,
    PurchaseOptionPrice: 0,
    PurchaseOptionReasonablyCertain: false,
    CarryingAmount: 0,
    FairValue: 25000000,
    SalesProceeds: 0,
    InitialDirectCosts: 200000,
    PrepaymentsBeforeCommencement: 0,
    LeaseIncentives: 0,
    PrepaidFirstPayment: true,
    Currency: 'NGN',
    IBR_Annual: 0.18,
    FXPolicy: 'Spot Rate',
    UsefulLifeYears: 10,
    LowValueExemption: false,
    ShortTermExemption: false,
    SeparateNonLeaseComponents: true,
    AllocationBasis: 'Standalone Price',
    JudgementNotes: 'Residual value guarantee included in lease liability',
    ApprovalSignoff: 'CFO - Emmanuel Okafor',
    LessorJurisdiction: 'Nigeria',
    LesseeJurisdiction: 'Nigeria',
    LessorAddress: '45 Fleet Street, Ikeja, Lagos',
    LesseeAddress: '78 Transport Avenue, Ojota, Lagos',
    LessorRCNumber: 'RC654987',
    LesseeRCNumber: 'RC987321',
    AssetLocation: 'Transport Solutions Depot, Ojota',
    DeliveryDateLatest: '2024-02-20',
    RiskTransferEvent: 'Upon delivery',
    InsuranceSumInsured: 25000000,
    InsuranceTPLimit: 8000000,
    InsurerRatingMin: 'B+',
    PermittedUse: 'Commercial transport',
    MoveRestriction: 'Nigeria only',
    SoftwareLicense: '',
    BankName: 'Fidelity Bank Plc',
    BankAccountName: 'Fleet Management Co',
    BankAccountNo: '6677889900',
    ArbitrationRules: 'LCIA Rules',
    SeatOfArbitration: 'Lagos, Nigeria',
    Language: 'English',
    GoverningLaw: 'Laws of Nigeria',
    LessorSignatoryTitle: 'Operations Manager',
    LesseeSignatoryTitle: 'Chief Financial Officer'
  },
  {
    ContractID: 'LC-2024-009',
    LesseeEntity: 'Energy Services Ltd',
    LessorName: 'Generator Leasing Ltd',
    AssetDescription: 'Caterpillar Generator 500KVA',
    AssetClass: 'Equipment',
    ContractDate: '2024-03-05',
    CommencementDate: '2024-03-20',
    EndDateOriginal: '2030-03-19',
    NonCancellableYears: 6,
    RenewalOptionYears: 3,
    RenewalOptionLikelihood: 0.7,
    TerminationOptionPoint: '',
    TerminationOptionLikelihood: 0,
    TerminationPenaltyExpected: 0,
    TerminationReasonablyCertain: false,
    FixedPaymentPerPeriod: 2200000,
    PaymentFrequency: 'Monthly',
    PaymentTiming: 'In Arrears',
    EscalationType: 'Fixed %',
    BaseCPI: 0,
    CPIResetMonth: 0,
    FirstResetYearOffset: 0,
    FixedEscalationPct: 0.06,
    VariablePaymentsInSubstanceFixed: 0,
    VariablePaymentsUsageExpected: 0,
    RVGExpected: 0,
    RVGReasonablyCertain: false,
    PurchaseOptionPrice: 80000000,
    PurchaseOptionReasonablyCertain: false,
    CarryingAmount: 0,
    FairValue: 180000000,
    SalesProceeds: 0,
    InitialDirectCosts: 5000000,
    PrepaymentsBeforeCommencement: 0,
    LeaseIncentives: 0,
    PrepaidFirstPayment: false,
    Currency: 'NGN',
    IBR_Annual: 0.15,
    FXPolicy: 'Spot Rate',
    UsefulLifeYears: 20,
    LowValueExemption: false,
    ShortTermExemption: false,
    SeparateNonLeaseComponents: true,
    AllocationBasis: 'Standalone Price',
    JudgementNotes: 'High renewal probability due to critical business need',
    ApprovalSignoff: 'CEO - Ibrahim Suleiman',
    LessorJurisdiction: 'Nigeria',
    LesseeJurisdiction: 'Nigeria',
    LessorAddress: '123 Power Equipment Road, Kano',
    LesseeAddress: '56 Industrial Avenue, Kaduna',
    LessorRCNumber: 'RC147258',
    LesseeRCNumber: 'RC369147',
    AssetLocation: 'Energy Services Plant, Kaduna',
    DeliveryDateLatest: '2024-03-20',
    RiskTransferEvent: 'Upon installation',
    InsuranceSumInsured: 180000000,
    InsuranceTPLimit: 40000000,
    InsurerRatingMin: 'A-',
    PermittedUse: 'Power generation',
    MoveRestriction: 'Fixed installation',
    SoftwareLicense: '',
    BankName: 'Union Bank of Nigeria',
    BankAccountName: 'Generator Leasing Ltd',
    BankAccountNo: '7788990011',
    ArbitrationRules: 'ICC Rules',
    SeatOfArbitration: 'Abuja, Nigeria',
    Language: 'English',
    GoverningLaw: 'Laws of Nigeria',
    LessorSignatoryTitle: 'Managing Director',
    LesseeSignatoryTitle: 'Chief Executive Officer'
  },
  {
    ContractID: 'LC-2024-010',
    LesseeEntity: 'Hospitality Group Ltd',
    LessorName: 'Furnishings & Fixtures Ltd',
    AssetDescription: 'Hotel Furniture Package - 50 Rooms',
    AssetClass: 'Equipment',
    ContractDate: '2024-01-25',
    CommencementDate: '2024-02-10',
    EndDateOriginal: '2029-02-09',
    NonCancellableYears: 5,
    RenewalOptionYears: 0,
    RenewalOptionLikelihood: 0,
    TerminationOptionPoint: '',
    TerminationOptionLikelihood: 0,
    TerminationPenaltyExpected: 0,
    TerminationReasonablyCertain: false,
    FixedPaymentPerPeriod: 1800000,
    PaymentFrequency: 'Monthly',
    PaymentTiming: 'In Advance',
    EscalationType: 'Fixed %',
    BaseCPI: 0,
    CPIResetMonth: 0,
    FirstResetYearOffset: 0,
    FixedEscalationPct: 0.03,
    VariablePaymentsInSubstanceFixed: 0,
    VariablePaymentsUsageExpected: 0,
    RVGExpected: 0,
    RVGReasonablyCertain: false,
    PurchaseOptionPrice: 30000000,
    PurchaseOptionReasonablyCertain: false,
    CarryingAmount: 0,
    FairValue: 95000000,
    SalesProceeds: 0,
    InitialDirectCosts: 3500000,
    PrepaymentsBeforeCommencement: 1800000,
    LeaseIncentives: 2000000,
    PrepaidFirstPayment: true,
    Currency: 'NGN',
    IBR_Annual: 0.16,
    FXPolicy: 'Spot Rate',
    UsefulLifeYears: 10,
    LowValueExemption: false,
    ShortTermExemption: false,
    SeparateNonLeaseComponents: true,
    AllocationBasis: 'Standalone Price',
    JudgementNotes: 'Furniture lease aligned with hotel renovation cycle',
    ApprovalSignoff: 'GM - Patricia Nwosu',
    LessorJurisdiction: 'Nigeria',
    LesseeJurisdiction: 'Nigeria',
    LessorAddress: '90 Furniture Plaza, Ikeja, Lagos',
    LesseeAddress: '15 Hotel Boulevard, VI, Lagos',
    LessorRCNumber: 'RC258369',
    LesseeRCNumber: 'RC741852',
    AssetLocation: 'Hospitality Group Hotel, Victoria Island',
    DeliveryDateLatest: '2024-02-10',
    RiskTransferEvent: 'Upon delivery and installation',
    InsuranceSumInsured: 95000000,
    InsuranceTPLimit: 25000000,
    InsurerRatingMin: 'A',
    PermittedUse: 'Hospitality operations',
    MoveRestriction: 'Fixed to hotel premises',
    SoftwareLicense: '',
    BankName: 'Diamond Bank Plc',
    BankAccountName: 'Furnishings & Fixtures Ltd',
    BankAccountNo: '8899001122',
    ArbitrationRules: 'LCIA Rules',
    SeatOfArbitration: 'Lagos, Nigeria',
    Language: 'English',
    GoverningLaw: 'Laws of Nigeria',
    LessorSignatoryTitle: 'Sales Director',
    LesseeSignatoryTitle: 'General Manager'
  }
];

// Create workbook
const wb = XLSX.utils.book_new();

// Convert demo data to worksheet format
const ws_data = [headers, ...demoData.map(row => headers.map(header => row[header] ?? ''))];
const ws = XLSX.utils.aoa_to_sheet(ws_data);

// Set column widths for better readability
const colWidths = headers.map(h => ({ wch: Math.max(h.length, 20) }));
ws['!cols'] = colWidths;

// Add worksheet to workbook
XLSX.utils.book_append_sheet(wb, ws, 'Lease Contracts');

// Add instructions sheet
const instructions = [
  ['IFRS 16 Lease Contract Import Template - Instructions'],
  [''],
  ['This template contains all required fields for importing lease contracts into the IFRS 16 Lease Engine.'],
  [''],
  ['IMPORTANT NOTES:'],
  ['1. Do not modify the header row (row 1) - all column names must match exactly'],
  ['2. Date fields should be in format: YYYY-MM-DD (e.g., 2024-01-15)'],
  ['3. Boolean fields (true/false) should contain: true or false (lowercase)'],
  ['4. Numeric fields should contain numbers only (no currency symbols)'],
  ['5. Likelihood fields should be between 0 and 1 (e.g., 0.7 for 70%)'],
  ['6. The template includes 10 sample rows - you can delete these and add your own data'],
  [''],
  ['FIELD DESCRIPTIONS:'],
  [''],
  ['Basic Identifiers:'],
  ['- ContractID: Unique identifier for the lease contract'],
  ['- LesseeEntity: Legal name of the lessee (tenant/user)'],
  ['- LessorName: Legal name of the lessor (landlord/owner)'],
  ['- AssetDescription: Description of the leased asset'],
  ['- AssetClass: Category (Real Estate, Vehicles, Equipment, etc.)'],
  [''],
  ['Dates:'],
  ['- ContractDate: Date when contract was signed'],
  ['- CommencementDate: Date when lease term begins'],
  ['- EndDateOriginal: Original end date of the lease'],
  [''],
  ['Term & Options:'],
  ['- NonCancellableYears: Non-cancellable period in years'],
  ['- RenewalOptionYears: Optional renewal period in years'],
  ['- RenewalOptionLikelihood: Probability of renewal (0-1)'],
  ['- TerminationOptionPoint: Date when termination option can be exercised'],
  ['- TerminationOptionLikelihood: Probability of termination (0-1)'],
  ['- TerminationPenaltyExpected: Expected penalty amount for early termination'],
  ['- TerminationReasonablyCertain: Is termination reasonably certain? (true/false)'],
  [''],
  ['Payments:'],
  ['- FixedPaymentPerPeriod: Fixed lease payment amount per period'],
  ['- PaymentFrequency: Monthly, Quarterly, Annually, etc.'],
  ['- PaymentTiming: In Advance or In Arrears'],
  [''],
  ['Escalation:'],
  ['- EscalationType: None, Fixed %, or CPI-Based'],
  ['- BaseCPI: Base CPI index (for CPI-based escalation)'],
  ['- CPIResetMonth: Month when CPI resets (1-12)'],
  ['- FirstResetYearOffset: Years until first CPI reset'],
  ['- FixedEscalationPct: Fixed escalation percentage (e.g., 0.05 for 5%)'],
  [''],
  ['Variable & Other:'],
  ['- VariablePaymentsInSubstanceFixed: Variable payments that are in-substance fixed'],
  ['- VariablePaymentsUsageExpected: Expected variable payments based on usage'],
  ['- RVGExpected: Expected residual value guarantee amount'],
  ['- RVGReasonablyCertain: Is RVG payment reasonably certain? (true/false)'],
  ['- PurchaseOptionPrice: Price to purchase asset at end of lease'],
  ['- PurchaseOptionReasonablyCertain: Is purchase reasonably certain? (true/false)'],
  [''],
  ['ROU Adjustments:'],
  ['- InitialDirectCosts: Initial direct costs incurred'],
  ['- PrepaymentsBeforeCommencement: Prepayments made before commencement'],
  ['- LeaseIncentives: Incentives received from lessor'],
  ['- PrepaidFirstPayment: Was first payment prepaid? (true/false)'],
  [''],
  ['Currency & Rates:'],
  ['- Currency: Currency code (NGN, USD, etc.)'],
  ['- IBR_Annual: Incremental borrowing rate (annual) as decimal (e.g., 0.15 for 15%)'],
  ['- FXPolicy: Foreign exchange policy'],
  [''],
  ['Policy Flags:'],
  ['- LowValueExemption: Applying low-value exemption? (true/false)'],
  ['- ShortTermExemption: Applying short-term exemption? (true/false)'],
  ['- SeparateNonLeaseComponents: Separate non-lease components? (true/false)'],
  ['- AllocationBasis: Basis for allocation (e.g., Standalone Price)'],
  [''],
  ['For more information, refer to the IFRS 16 methodology documentation in the application.']
];

const ws_instructions = XLSX.utils.aoa_to_sheet(instructions);
ws_instructions['!cols'] = [{ wch: 100 }];
XLSX.utils.book_append_sheet(wb, ws_instructions, 'Instructions');

// Write file to public folder
const outputPath = path.join(__dirname, '..', 'public', 'import-template.xlsx');
XLSX.writeFile(wb, outputPath);

console.log(`âœ… Import template created successfully at: ${outputPath}`);
console.log(`ðŸ“‹ Template includes ${demoData.length} demo rows with comprehensive lease data`);
console.log(`ðŸ“Š Total columns: ${headers.length}`);
